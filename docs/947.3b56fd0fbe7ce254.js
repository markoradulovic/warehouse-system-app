"use strict";(self.webpackChunkwarehouse_system_app=self.webpackChunkwarehouse_system_app||[]).push([[947],{6947:(f,d,i)=>{i.r(d),i.d(d,{ProductFormComponent:()=>u});var p=i(6895),o=i(433),l=i(4004);class m{static checkCodeValidator(e){return r=>e.getProducts().pipe((0,l.U)(c=>c.some(n=>n.code===r.value)?{codeExists:!0}:null))}}var t=i(8256),h=i(3926),a=i(4940);function b(s,e){if(1&s){const r=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(r);const n=t.oxw();return t.KtG(n.onDelete())}),t._uU(1," Delete Product "),t.qZA()}}class u{get id(){return this.productForm?.get("productId")}get code(){return this.productForm?.get("productCode")}get quantity(){return this.productForm?.get("productQuantity")}get floor(){return this.productForm?.get("productFloor")}get section(){return this.productForm?.get("productSection")}constructor(e,r,c,n){this.productService=e,this.formBuilder=r,this.router=c,this.route=n}ngOnInit(){this.buildForm(),this.getRouteData(),this.isNewProduct||this.populateForm()}ngOnDestroy(){this.getProductSubscription&&this.getProductSubscription.unsubscribe(),this.addProductSubscription&&this.addProductSubscription.unsubscribe(),this.updateProductSubscription&&this.updateProductSubscription.unsubscribe(),this.deleteProductSubscription&&this.deleteProductSubscription.unsubscribe(),this.routeSubscription&&this.routeSubscription.unsubscribe()}buildForm(){this.productForm=this.formBuilder.group({productId:[null],productCode:[null,o.kI.compose([o.kI.required,o.kI.pattern(/[A-Z]{2,4}\s[0-9]{4,6}/)]),[m.checkCodeValidator(this.productService)]],productQuantity:[null,o.kI.required],productFloor:[null,o.kI.compose([o.kI.required,o.kI.min(1),o.kI.max(3)])],productSection:[null,o.kI.compose([o.kI.required,o.kI.min(1),o.kI.max(3)])]})}populateForm(){const e=this.route.snapshot.paramMap.get("id");this.getProductSubscription=this.productService.getProduct(+e).subscribe(r=>{this.id.setValue(r?.id),this.code.setValue(r?.code),this.code.disable(),this.quantity.setValue(r?.quantity),this.floor.setValue(r?.floor),this.section.setValue(r?.section)})}getRouteData(){this.routeSubscription=this.route.data.subscribe(e=>this.isNewProduct=e.isNew)}onSave(){const e={id:this.id.value?this.id.value:Math.floor(100*Math.random()),code:this.code.value,quantity:this.quantity.value,floor:this.floor.value,section:this.section.value};this.isNewProduct&&(this.addProductSubscription=this.productService.createProduct(e).subscribe(()=>this.router.navigate(["/home"]))),this.isNewProduct||(this.updateProductSubscription=this.productService.updateProduct(e).subscribe(()=>this.router.navigate(["/home"])))}onDelete(){this.deleteProductSubscription=this.productService.deleteProduct(this.id.value).subscribe(()=>this.router.navigate(["/home"]))}}u.\u0275fac=function(e){return new(e||u)(t.Y36(h.M),t.Y36(o.qu),t.Y36(a.F0),t.Y36(a.gz))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-product-form"]],standalone:!0,features:[t.jDz],decls:20,vars:3,consts:[[3,"formGroup"],["for","code"],["type","text","id","code","formControlName","productCode"],["for","quantity"],["type","number","id","quantity","formControlName","productQuantity"],["for","floor"],["type","number","id","floor","formControlName","productFloor"],["for","section"],["type","number","id","section","formControlName","productSection"],["type","button",3,"disabled","click"],["type","button",3,"click",4,"ngIf"],["type","button",3,"click"]],template:function(e,r){1&e&&(t.TgZ(0,"form",0)(1,"div")(2,"label",1),t._uU(3,"Product Code *"),t.qZA(),t._UZ(4,"input",2),t.qZA(),t.TgZ(5,"div")(6,"label",3),t._uU(7,"Quantity *"),t.qZA(),t._UZ(8,"input",4),t.qZA(),t.TgZ(9,"div")(10,"label",5),t._uU(11,"Floor *"),t.qZA(),t._UZ(12,"input",6),t.qZA(),t.TgZ(13,"div")(14,"label",7),t._uU(15,"Section *"),t.qZA(),t._UZ(16,"input",8),t.qZA(),t.TgZ(17,"button",9),t.NdJ("click",function(){return r.onSave()}),t._uU(18," Save Product "),t.qZA(),t.YNc(19,b,2,0,"button",10),t.qZA()),2&e&&(t.Q6J("formGroup",r.productForm),t.xp6(17),t.Q6J("disabled",r.productForm.invalid),t.xp6(2),t.Q6J("ngIf",!r.isNewProduct))},dependencies:[p.O5,o.UX,o._Y,o.Fj,o.wV,o.JJ,o.JL,o.sg,o.u]})}}]);