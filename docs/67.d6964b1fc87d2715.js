"use strict";(self.webpackChunkwarehouse_system_app=self.webpackChunkwarehouse_system_app||[]).push([[67],{3067:(V,p,i)=>{i.r(p),i.d(p,{ProductFormComponent:()=>u});var l=i(6895),r=i(433),_=i(7579),c=i(2722),m=i(4004);class f{static uniqueCodeValidator(e){return t=>e.getProducts().pipe((0,m.U)(s=>s.some(a=>a.code===t.value)?{codeExists:!0}:null))}static emptyLocationValidator(e){return t=>e.getProducts().pipe((0,m.U)(s=>s.some(a=>a.floor===t.get("productFloor").value&&a.section===t.get("productSection").value)?{locationTaken:!0}:null))}}var o=i(8256),h=i(3926),g=i(4940);function C(n,e){1&n&&(o.TgZ(0,"span",16),o._uU(1,"Add Product"),o.qZA())}function P(n,e){1&n&&(o.TgZ(0,"span",16),o._uU(1,"Edit Product"),o.qZA())}function y(n,e){1&n&&(o.TgZ(0,"span",19),o._uU(1," Unique product code is required. "),o.qZA())}function q(n,e){1&n&&(o.TgZ(0,"span",19),o._uU(1," Code format is 2-4 uppercase letters, empty space and 4-6 digits. "),o.qZA())}function Z(n,e){1&n&&(o.TgZ(0,"span",19),o._uU(1," Code must be unique."),o.qZA())}function v(n,e){if(1&n&&(o.TgZ(0,"span",17),o.YNc(1,y,2,0,"span",18),o.YNc(2,q,2,0,"span",18),o.YNc(3,Z,2,0,"span",18),o.qZA()),2&n){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",t.code.hasError("required")),o.xp6(1),o.Q6J("ngIf",t.code.hasError("pattern")),o.xp6(1),o.Q6J("ngIf",t.code.hasError("codeExists"))}}function F(n,e){1&n&&(o.TgZ(0,"span",19),o._uU(1," Product quantity is required. "),o.qZA())}function T(n,e){1&n&&(o.TgZ(0,"span",19),o._uU(1," Maximum quantity is 100. "),o.qZA())}function b(n,e){if(1&n&&(o.TgZ(0,"span",17),o.YNc(1,F,2,0,"span",18),o.YNc(2,T,2,0,"span",18),o.qZA()),2&n){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",t.quantity.hasError("required")),o.xp6(1),o.Q6J("ngIf",t.quantity.hasError("max"))}}function x(n,e){1&n&&(o.TgZ(0,"span",19),o._uU(1," Floor is required. "),o.qZA())}function I(n,e){1&n&&(o.TgZ(0,"span",19),o._uU(1," Floor range is 1-3. "),o.qZA())}function A(n,e){1&n&&(o.TgZ(0,"span",19),o._uU(1," Floor range is 1-3."),o.qZA())}function N(n,e){if(1&n&&(o.TgZ(0,"span",17),o.YNc(1,x,2,0,"span",18),o.YNc(2,I,2,0,"span",18),o.YNc(3,A,2,0,"span",18),o.qZA()),2&n){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",t.floor.hasError("required")),o.xp6(1),o.Q6J("ngIf",t.floor.hasError("min")),o.xp6(1),o.Q6J("ngIf",t.floor.hasError("max"))}}function Q(n,e){1&n&&(o.TgZ(0,"span",19),o._uU(1," Section is required. "),o.qZA())}function J(n,e){1&n&&(o.TgZ(0,"span",19),o._uU(1," Section range is 1-3. "),o.qZA())}function U(n,e){1&n&&(o.TgZ(0,"span",19),o._uU(1," Section range is 1-3."),o.qZA())}function k(n,e){if(1&n&&(o.TgZ(0,"span",17),o.YNc(1,Q,2,0,"span",18),o.YNc(2,J,2,0,"span",18),o.YNc(3,U,2,0,"span",18),o.qZA()),2&n){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",t.section.hasError("required")),o.xp6(1),o.Q6J("ngIf",t.section.hasError("min")),o.xp6(1),o.Q6J("ngIf",t.section.hasError("max"))}}function M(n,e){1&n&&(o.TgZ(0,"span",19),o._uU(1," This location is already taken. "),o.qZA())}function Y(n,e){if(1&n&&(o.TgZ(0,"span",17),o.YNc(1,M,2,0,"span",18),o.qZA()),2&n){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",t.productForm.hasError("locationTaken"))}}function O(n,e){if(1&n){const t=o.EpF();o.ynx(0),o.TgZ(1,"button",20),o.NdJ("click",function(){o.CHM(t);const a=o.oxw();return o.KtG(a.onDelete())}),o._uU(2," Delete Product "),o.qZA(),o.BQk()}}const d=function(n){return{"is-invalid":n}},S=function(n){return{"is-disabled":n}};class u{get id(){return this.productForm?.get("productId")}get code(){return this.productForm?.get("productCode")}get quantity(){return this.productForm?.get("productQuantity")}get floor(){return this.productForm?.get("productFloor")}get section(){return this.productForm?.get("productSection")}constructor(e,t,s,a){this.productService=e,this.formBuilder=t,this.router=s,this.route=a,this.destroy$=new _.x}ngOnInit(){this.buildForm(),this.getRouteData(),this.isNewProduct||this.populateForm()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}buildForm(){this.productForm=this.formBuilder.group({productId:[null],productCode:[null,r.kI.compose([r.kI.required,r.kI.pattern(/[A-Z]{2,4}\s[0-9]{4,6}/)]),f.uniqueCodeValidator(this.productService)],productQuantity:[null,r.kI.compose([r.kI.required,r.kI.max(100)])],productFloor:[null,r.kI.compose([r.kI.required,r.kI.min(1),r.kI.max(3)])],productSection:[null,r.kI.compose([r.kI.required,r.kI.min(1),r.kI.max(3)])]},{validators:null,asyncValidators:f.emptyLocationValidator(this.productService)})}populateForm(){const e=this.route.snapshot.paramMap.get("id");this.productService.getProduct(+e).pipe((0,c.R)(this.destroy$)).subscribe(t=>{this.id.setValue(t?.id),this.code.setValue(t?.code),this.code.disable(),this.quantity.setValue(t?.quantity),this.floor.setValue(t?.floor),this.section.setValue(t?.section),this.productForm.clearAsyncValidators(),this.productForm.updateValueAndValidity()})}getRouteData(){this.route.data.pipe((0,c.R)(this.destroy$)).subscribe(e=>this.isNewProduct=e.isNew)}onSave(){const e={id:this.id.value?this.id.value:Math.floor(100*Math.random()),code:this.code.value,quantity:this.quantity.value,floor:this.floor.value,section:this.section.value};this.isNewProduct&&this.productService.createProduct(e).pipe((0,c.R)(this.destroy$)).subscribe(()=>this.router.navigate(["/home"])),this.isNewProduct||this.productService.updateProduct(e).pipe((0,c.R)(this.destroy$)).subscribe(()=>this.router.navigate(["/home"]))}onDelete(){this.productService.deleteProduct(this.id.value).pipe((0,c.R)(this.destroy$)).subscribe(()=>this.router.navigate(["/home"]))}}u.\u0275fac=function(e){return new(e||u)(o.Y36(h.M),o.Y36(r.qu),o.Y36(g.F0),o.Y36(g.gz))},u.\u0275cmp=o.Xpm({type:u,selectors:[["app-product-form"]],standalone:!0,features:[o.jDz],decls:29,vars:25,consts:[["autocomplete","off",1,"form",3,"formGroup"],["class","form-title",4,"ngIf","ngIfElse"],["editProduct",""],[1,"form-row"],["for","code",1,"form-label"],["type","text","id","code","placeholder","Unique Product Code","formControlName","productCode",1,"form-input",3,"ngClass"],["class","invalid",4,"ngIf"],["for","quantity",1,"form-label"],["type","number","min","1","id","quantity","placeholder","Product Quantity","formControlName","productQuantity",1,"form-input",3,"ngClass"],["for","floor",1,"form-label"],["type","number","min","1","id","floor","placeholder","Floor 1-3","formControlName","productFloor",1,"form-input",3,"ngClass"],["for","section",1,"form-label"],["type","number","id","section","min","1","placeholder","Section 1-3","formControlName","productSection",1,"form-input",3,"ngClass"],[1,"form-footer"],["type","button",1,"form-button",3,"disabled","ngClass","click"],[4,"ngIf"],[1,"form-title"],[1,"invalid"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],["type","button",1,"form-button",3,"click"]],template:function(e,t){if(1&e&&(o.TgZ(0,"form",0),o.YNc(1,C,2,0,"span",1),o.YNc(2,P,2,0,"ng-template",null,2,o.W1O),o.TgZ(4,"div",3)(5,"label",4),o._uU(6,"Product Code *"),o.qZA(),o._UZ(7,"input",5),o.YNc(8,v,4,3,"span",6),o.qZA(),o.TgZ(9,"div",3)(10,"label",7),o._uU(11,"Quantity *"),o.qZA(),o._UZ(12,"input",8),o.YNc(13,b,3,2,"span",6),o.qZA(),o.TgZ(14,"div",3)(15,"label",9),o._uU(16,"Floor *"),o.qZA(),o._UZ(17,"input",10),o.YNc(18,N,4,3,"span",6),o.qZA(),o.TgZ(19,"div",3)(20,"label",11),o._uU(21,"Section *"),o.qZA(),o._UZ(22,"input",12),o.YNc(23,k,4,3,"span",6),o.qZA(),o.YNc(24,Y,2,1,"span",6),o.TgZ(25,"div",13)(26,"button",14),o.NdJ("click",function(){return t.onSave()}),o._uU(27," Save Product "),o.qZA(),o.YNc(28,O,3,0,"ng-container",15),o.qZA()()),2&e){const s=o.MAs(3);o.Q6J("formGroup",t.productForm),o.xp6(1),o.Q6J("ngIf",t.isNewProduct)("ngIfElse",s),o.xp6(6),o.Q6J("ngClass",o.VKq(15,d,(t.code.touched||t.code.dirty)&&!t.code.valid)),o.xp6(1),o.Q6J("ngIf",(t.code.touched||t.code.dirty)&&!t.code.valid),o.xp6(4),o.Q6J("ngClass",o.VKq(17,d,(t.quantity.touched||t.quantity.dirty)&&!t.quantity.valid)),o.xp6(1),o.Q6J("ngIf",(t.quantity.touched||t.quantity.dirty)&&!t.quantity.valid),o.xp6(4),o.Q6J("ngClass",o.VKq(19,d,(t.floor.touched||t.floor.dirty)&&!t.floor.valid)),o.xp6(1),o.Q6J("ngIf",(t.floor.touched||t.floor.dirty)&&!t.floor.valid),o.xp6(4),o.Q6J("ngClass",o.VKq(21,d,(t.section.touched||t.section.dirty)&&!t.section.valid)),o.xp6(1),o.Q6J("ngIf",(t.section.touched||t.section.dirty)&&!t.section.valid),o.xp6(1),o.Q6J("ngIf",(t.productForm.touched||t.productForm.dirty)&&!t.productForm.valid),o.xp6(2),o.Q6J("disabled",t.productForm.invalid)("ngClass",o.VKq(23,S,t.productForm.invalid)),o.xp6(2),o.Q6J("ngIf",!t.isNewProduct)}},dependencies:[r.UX,r._Y,r.Fj,r.wV,r.JJ,r.JL,r.qQ,r.sg,r.u,l.O5,l.mk],styles:[".form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem;justify-content:flex-start;margin:1rem}.form-title[_ngcontent-%COMP%]{color:#000;font-size:1.3rem}.form-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;gap:2.5%}.form-label[_ngcontent-%COMP%]{font-size:1.1rem;color:#333;padding:.25rem;max-width:20rem}.form-input[_ngcontent-%COMP%]{color:#333;font-size:1.1rem;border:.05rem solid #333;border-radius:.5rem;padding:.25rem;max-width:20rem}.form-select[_ngcontent-%COMP%]{color:#333;font-size:1.1rem;border:.05rem solid #333;border-radius:.5rem;padding:.25rem}.form-option[_ngcontent-%COMP%]{color:#333}.form-button[_ngcontent-%COMP%]{color:#fff;background-color:#22c064;font-size:1.2rem;border:.05rem solid #22c064;border-radius:.5rem;padding:.5rem}.form-button[_ngcontent-%COMP%]:hover{cursor:pointer}.form-button[_ngcontent-%COMP%]:disabled{background-color:#333;border:.05rem solid #333}.form-button[_ngcontent-%COMP%]:disabled:hover{cursor:default}.form-footer[_ngcontent-%COMP%]{display:flex;gap:1rem;padding:1rem}.form[_ngcontent-%COMP%]   .is-invalid[_ngcontent-%COMP%]{border:.1rem solid #ff285a}.form[_ngcontent-%COMP%]   .invalid[_ngcontent-%COMP%]{margin-top:.5rem}.form[_ngcontent-%COMP%]   .invalid-feedback[_ngcontent-%COMP%]{font-size:1.1rem;color:#ff285a}"]})}}]);